# JavaScript/TypeScript Security Rules

sources:
  - req.query
  - req.body
  - req.params
  - req.cookies
  - req.headers
  - process.argv
  - location.search
  - location.hash
  - window.name
  - document.URL
  - document.referrer

rules:
  # --- XSS (Cross-Site Scripting) ---
  - name: "xss-innerhtml"
    pattern: "innerHTML"
    severity: "High"
    message: "The '.innerHTML' usage with unsanitized content can cause XSS vulnerability. Use '.textContent' or DOMPurify!"

  - name: "xss-outerhtml"
    pattern: "outerHTML"
    severity: "High"
    message: "The '.outerHTML' usage with unsanitized content can cause XSS vulnerability."

  - name: "xss-document-write"
    pattern: "document.write"
    severity: "High"
    message: "The 'document.write()' with unsanitized content can cause XSS vulnerability. Avoid using it!"

  - name: "xss-eval"
    pattern: "eval("
    severity: "Critical"
    message: "The 'eval()' usage nem megbízható inputtal RCE vagy can cause XSS vulnerability. Avoid using it!"

  - name: "xss-function-constructor"
    pattern: "Function("
    severity: "Critical"
    message: "The 'Function()' constructor nem megbízható inputtal code injection causes vulnerabilityhat."

  - name: "xss-settimeout-string"
    pattern: "setTimeout("
    severity: "High"
    message: "The 'setTimeout()' with string parameter code injection causes vulnerabilityhat. Use function helyette!"

  - name: "xss-setinterval-string"
    pattern: "setInterval("
    severity: "High"
    message: "The 'setInterval()' with string parameter code injection causes vulnerabilityhat. Use function helyette!"

  # --- Command Injection (Node.js) ---
  - name: "command-injection-exec"
    pattern: "exec("
    severity: "Critical"
    message: "The 'child_process.exec()' with unvalidated input command injection causes vulnerability. Use 'execFile()' vagy 'spawn()'!"

  - name: "command-injection-execsync"
    pattern: "execSync("
    severity: "Critical"
    message: "The 'child_process.execSync()' with unvalidated input command injection causes vulnerability."

  # --- SQL Injection ---
  - name: "sql-injection-query"
    pattern: ".query("
    severity: "Critical"
    message: "SQL query string konkatenációval SQL injection causes vulnerability. Use parameterized query-ket!"

  - name: "sql-injection-execute"
    pattern: ".execute("
    severity: "Critical"
    message: "SQL execute string konkatenációval SQL injection causes vulnerability. Use prepared statements-et!"

  # --- Path Traversal ---
  - name: "pathraversal-readfile"
    pattern: "fs.readFile("
    severity: "High"
    message: "The 'fs.readFile()' nem validált elérési útvonallal path traversal causes vulnerabilityhat."

  - name: "pathraversal-readfilesync"
    pattern: "fs.readFileSync("
    severity: "High"
    message: "The 'fs.readFileSync()' nem validált elérési útvonallal path traversal causes vulnerabilityhat."

  - name: "pathraversal-writefile"
    pattern: "fs.writeFile("
    severity: "High"
    message: "The 'fs.writeFile()' nem validált elérési útvonallal path traversal causes vulnerabilityhat."

  # --- Weak Cryptography ---
  - name: "weak-crypto-md5"
    pattern: "crypto.createHash('md5')"
    severity: "Medium"
    message: "Az MD5 hash algoritmus kriptográfiai szempontból gyenge és törött. Use SHA-256 vagy erősebbet!"

  - name: "weak-crypto-sha1"
    pattern: "crypto.createHash('sha1')"
    severity: "Medium"
    message: "A SHA-1 hash algoritmus kriptográfiai szempontból gyenge és törött. Use SHA-256 vagy erősebbet!"

  - name: "weak-random-pseudorandombytes"
    pattern: "crypto.pseudoRandomBytes"
    severity: "Medium"
    message: "The 'crypto.pseudoRandomBytes()' not cryptographically secure. Use 'crypto.randomBytes()'!"

  - name: "weak-random-math-random"
    pattern: "Math.random()"
    severity: "Low"
    message: "The 'Math.random()' not cryptographically secure. Biztonsági célokra használj 'crypto.randomBytes()'!"

  # --- Prototype Pollution ---
  - name: "prototype-pollution-merge"
    pattern: "Object.assign("
    severity: "Medium"
    message: "The 'Object.assign()' nem validált objektummal prototype pollution causes vulnerabilityhat. Ellenőrizd az inputot!"

  - name: "prototype-pollution-lodash-merge"
    pattern: "_.merge("
    severity: "Medium"
    message: "The 'lodash.merge()' nem validált objektummal prototype pollution causes vulnerabilityhat."

  # --- Open Redirect ---
  - name: "open-redirect-location"
    pattern: "location.href ="
    severity: "Medium"
    message: "The 'location.href' with unvalidated URL open redirect causes vulnerabilityhat."

  - name: "open-redirect-window-location"
    pattern: "window.location ="
    severity: "Medium"
    message: "The 'window.location' with unvalidated URL open redirect causes vulnerabilityhat."

  # --- Insecure Deserialization ---
  - name: "insecure-deserialization-unserialize"
    pattern: "unserialize("
    severity: "Critical"
    message: "The 'unserialize()' nem megbízható forrásból RCE causes vulnerability. Ne használd nem megbízható inputtal!"

  - name: "insecure-deserialization-eval-json"
    pattern: "eval("
    severity: "Critical"
    message: "JSON parse-olásra 'eval()' usage RCE causes vulnerability. Use 'JSON.parse()'!"

  # --- SSRF ---
  - name: "ssrf-fetch"
    pattern: "fetch("
    severity: "High"
    message: "The 'fetch()' with unvalidated URL SSRF causes vulnerabilityhat."

  - name: "ssrf-axios-get"
    pattern: "axios.get("
    severity: "High"
    message: "The 'axios.get()' with unvalidated URL SSRF causes vulnerabilityhat."

  - name: "ssrf-request"
    pattern: "request("
    severity: "High"
    message: "The 'request()' with unvalidated URL SSRF causes vulnerabilityhat."

  # --- Regex DoS ---
  - name: "regex-dos"
    pattern: "RegExp("
    severity: "Low"
    message: "The 'RegExp()' bonyolult regex-szel ReDoS (Regular Expression Denial of Service) támadásnak lehet kitéve."
