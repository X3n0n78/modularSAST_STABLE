rules:
  # --- Command Injection ---
  - name: "unsafe-exec-command"
    pattern: "exec.Command"
    severity: "High"
    message: "The 'exec.Command' call with single string can allow shell injection. Use argument list."

  - name: "unsafe-exec-commandcontext"
    pattern: "exec.CommandContext"
    severity: "High"
    message: "The 'exec.CommandContext' with unvalidated input can cause command injection vulnerability."

  # --- Path Traversal ---
  - name: "path-traversal-os-open"
    pattern: "os.Open"
    severity: "High"
    message: "The 'os.Open()' with unvalidated path can cause path traversal vulnerability. Use 'filepath.Clean()' and validation!"

  - name: "path-traversal-os-create"
    pattern: "os.Create"
    severity: "High"
    message: "The 'os.Create()' with unvalidated path can cause path traversal vulnerability. Validate the path!"

  - name: "path-traversal-os-readfile"
    pattern: "os.ReadFile"
    severity: "High"
    message: "The 'os.ReadFile()' with unvalidated path can cause path traversal vulnerability. Use 'filepath.Clean()' and validation!"

  - name: "path-traversal-os-writefile"
    pattern: "os.WriteFile"
    severity: "High"
    message: "The 'os.WriteFile()' with unvalidated path can cause path traversal vulnerability. Validate the path!"

  # --- XSS (Cross-Site Scripting) ---
  - name: "xss-template-html"
    pattern: "template.HTML"
    severity: "High"
    message: "The 'template.HTML()' with unvalidated content can cause XSS vulnerability. Use Go template engine auto-escaping feature!"

  - name: "xss-template-js"
    pattern: "template.JS"
    severity: "High"
    message: "The 'template.JS()' with unvalidated content can cause XSS vulnerability. Avoid using it or validate the input!"

  - name: "xss-template-url"
    pattern: "template.URL"
    severity: "Medium"
    message: "The 'template.URL()' with unvalidated content can cause open redirect or XSS vulnerability."

  # --- Weak Cryptography ---
  - name: "weak-crypto-md5"
    pattern: "crypto/md5"
    severity: "Medium"
    message: "The MD5 hash algorithm is cryptographically weak and broken. Use SHA-256 or stronger!"

  - name: "weak-crypto-sha1"
    pattern: "crypto/sha1"
    severity: "Medium"
    message: "The SHA-1 hash algorithm is cryptographically weak and broken. Use SHA-256 or stronger!"

  - name: "weak-crypto-des"
    pattern: "crypto/des"
    severity: "Critical"
    message: "The DES encryption is obsolete and broken. Use AES instead!"

  - name: "weak-crypto-rc4"
    pattern: "crypto/rc4"
    severity: "Critical"
    message: "The RC4 encryption is obsolete and broken. Use AES instead!"

  # --- SQL Injection ---
  - name: "sql-injection-exec"
    pattern: "db.Exec"
    severity: "Critical"
    message: "The 'db.Exec()' with string concatenation can cause SQL injection vulnerability. Use parameterized queries!"

  - name: "sql-injection-query"
    pattern: "db.Query"
    severity: "Critical"
    message: "The 'db.Query()' with string concatenation can cause SQL injection vulnerability. Use parameterized queries!"

  - name: "sql-injection-queryrow"
    pattern: "db.QueryRow"
    severity: "Critical"
    message: "The 'db.QueryRow()' with string concatenation can cause SQL injection vulnerability. Use parameterized queries!"

  # --- Insecure Random ---
  - name: "weak-random-math-rand"
    pattern: "math/rand"
    severity: "Medium"
    message: "The 'math/rand' is not cryptographically secure. For security purposes use 'crypto/rand'!"

  # --- Insecure TLS ---
  - name: "insecure-tls-skip-verify"
    pattern: "InsecureSkipVerify"
    severity: "High"
    message: "The 'InsecureSkipVerify: true' disables TLS certificate validation and can be exposed to MITM attack!"

  # --- SSRF (Server-Side Request Forgery) ---
  - name: "ssrf-http-get"
    pattern: "http.Get"
    severity: "High"
    message: "The 'http.Get()' with unvalidated URL can cause SSRF (Server-Side Request Forgery) vulnerability."

  - name: "ssrf-http-post"
    pattern: "http.Post"
    severity: "High"
    message: "The 'http.Post()' with unvalidated URL can cause SSRF vulnerability."

  # --- Unsafe Reflection ---
  - name: "unsafe-reflect"
    pattern: "reflect.ValueOf"
    severity: "Low"
    message: "The 'reflect' package usage with unvalidated input can pose a security risk."

  # --- Unsafe Package ---
  - name: "unsafe-package"
    pattern: "unsafe.Pointer"
    severity: "Medium"
    message: "The 'unsafe' package usage can cause memory safety problems. Only if absolutely necessary!"
